generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id          String   @id @default(uuid())
  email       String   @unique
  password    String
  name        String?  // Nome Completo
  birthDate   String?  // Data de Nascimento
  phone       String?  // WhatsApp
  gender      String?  // Masculino, Feminino, Outro
  role        String   @default("USER") // ADMIN ou USER
  createdAt   DateTime @default(now())
  
  workouts    Workout[]
  anamneses   Anamnese[] // Mudei para plural para suportar histórico
}

model Exercise {
  id              String            @id @default(uuid())
  name            String            @unique
  category        String
  videoUrl        String?
  instructions    String?
  createdAt       DateTime          @default(now())
  workoutExercise WorkoutExercise[]
}

model Workout {
  id        String            @id @default(uuid())
  name      String            // Ex: "Treino A - Peito e Tríceps"
  userId    String
  user      User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  exercises WorkoutExercise[]
  createdAt DateTime          @default(now())
}

model WorkoutExercise {
  id         String   @id @default(uuid())
  workoutId  String
  workout    Workout  @relation(fields: [workoutId], references: [id], onDelete: Cascade)
  exerciseId String
  exercise   Exercise @relation(fields: [exerciseId], references: [id])
  title      String?  // Caso queira dar um nome customizado ao exercício no treino
  sets       Int      @default(3)
  reps       String   @default("12") // Mudei para String para aceitar "3x12" ou "Até a falha"
  notes      String?  // Observações (ex: Descanso de 60s)
}

model Anamnese {
  id              String   @id @default(uuid())
  userId          String
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // 1. Métricas
  peso            Float
  altura          Float
  imc             Float?   // Calcularemos no App e salvaremos aqui
  aguaIdeal       Float?   // Calcularemos no App e salvaremos aqui

  // 2. Perfil
  objetivo        String   // Hipertrofia, Emagrecimento...
  nivel           String   // Iniciante, Atleta...
  
  // 3. Disponibilidade
  frequencia      Int      // 1 a 7 dias
  tempoDisponivel Int      @default(60) // Minutos

  // 4. Saúde (Arrays de String)
  limitacoes      String[] // ["Joelho", "Lombar"]
  cirurgias       String[] // ["Silicone", "Cesárea"]
  equipamentos    String[] // Mantive caso queira usar no futuro, se não, pode remover

  createdAt       DateTime @default(now())
}