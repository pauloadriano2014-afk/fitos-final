generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String?  
  birthDate String?  
  phone     String?  
  gender    String?  
  
  // NOVO CAMPO IMPORTANTE
  plan_tier String   @default("standard") // "vip" ou "standard"
  
  role      String   @default("USER") // ADMIN ou USER
  createdAt DateTime @default(now())
  
  workouts  Workout[]
  anamneses Anamnese[]
}

model Exercise {
  id              String            @id @default(uuid())
  name            String            @unique
  category        String
  videoUrl        String?
  instructions    String?
  createdAt       DateTime          @default(now())
  workoutExercise WorkoutExercise[]
}

model Workout {
  id        String   @id @default(uuid())
  name      String   
  
  // A TRAVA DE SEGURANÇA (VIP = false, Standard = true)
  isVisible Boolean  @default(true) 

  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  exercises WorkoutExercise[]
  createdAt DateTime @default(now())
}

model WorkoutExercise {
  id         String   @id @default(uuid())
  workoutId  String
  workout    Workout  @relation(fields: [workoutId], references: [id], onDelete: Cascade)
  exerciseId String
  exercise   Exercise @relation(fields: [exerciseId], references: [id])
  title      String?  
  sets       Int      @default(3)
  reps       String   @default("12") 
  notes      String?  
}

model Anamnese {
  id              String   @id @default(uuid())
  userId          String
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // 1. Métricas
  peso            Float
  altura          Float
  imc             Float?   
  aguaIdeal       Float?   

  // 2. Perfil
  objetivo        String   
  nivel           String   
  
  // 3. Disponibilidade
  frequencia      Int      
  tempoDisponivel Int      @default(60) 

  // 4. Saúde (Arrays de String)
  limitacoes      String[] 
  cirurgias       String[] 
  equipamentos    String[] 

  // 5. NUTRIÇÃO (NOVOS CAMPOS VIP)
  refeicoesDia     Int?     @default(3)
  alergias         String[] // Ex: ["Gluten", "Lactose"]
  alimentosAversao String[] // O que ele odeia comer
  suplementos      String[] // O que ele já toma

  createdAt        DateTime @default(now())
}